<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard | Latency Slayer</title>
    <script src="script/components/navBar.js"></script>
    <script src="script/components/kpi.js"></script>
    <link rel="stylesheet" href="style/dashboardManagement.css" />
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  </head>
  <body onload="getChamados()">
    <nav-bar></nav-bar>

    <main>
      <div class="kpis">
        <div class="kpi">
          <div class="titulo-kpi">Chamados abertos sem responsável</div>
          <div class="kpi-infos">
            <div class="kpi-numeros" id="kpi-chamados-abertos"></div>
            <div class="kpi-mensagem">Chamados em aberto sem responsável</div>
          </div>

          <div class="rodape">
            <div class="label">60% do total de chamados (total de 20)</div>
            <img class="tooltip" src="img/tooltip.png" />
          </div>
        </div>

        <div class="kpi">
          <div class="titulo-kpi">Colaboradores sem chamados atribuídos</div>
          <div class="kpi-infos">
            <div class="kpi-numeros">1212</div>
            <div class="kpi-mensagem">colaboradores estão sem atribuição</div>
          </div>

          <div class="rodape">
            <div class="label">60% do total de chamados (total de 20)</div>
            <img class="tooltip" src="img/tooltip.png" />
          </div>
        </div>

        <div class="kpi">
          <div class="titulo-kpi">
            Top servidores com mais ocorrências (em 7 dias)
          </div>
          <div class="kpi-infos-col">
            <div class="label">40% do total de colaboradores (total de 50)</div>
            <div class="label">40% do total de colaboradores (total de 50)</div>
            <div class="label">40% do total de colaboradores (total de 50)</div>
          </div>
        </div>
      </div>

      <div class="graficos">
        <div class="graficos-linha-1">
          <div class="first-grafico-linha-1">
            <div class="box-first-grafico-linha-1">
              <div class="titulo-first-grafico-linha-1">
                Número de chamados do mês
              </div>

              <div id="chart"></div>
            </div>
          </div>

          <div class="second-grafico-linha-1">
            <div class="box-second-grafico-linha-1">
              <div class="titulo-second-grafico-linha-1">
                Lista de chamados sem responsável
              </div>

              <div class="lista-second-grafico-linha-1">
                <table>
                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div class="graficos-linha-2">
          <div class="first-grafico-linha-2">
            <div class="box-first-grafico-linha-2">
              <div class="titulo-first-grafico-linha-2">
                Lista de responsável sem atribuição
              </div>

              <div class="lista-first-grafico-linha-2">
                <table>
                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Email</th>
                    <th>Grupo</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="second-grafico-linha-2">
            <div class="box-second-grafico-linha-2">
              <div class="titulo-second-grafico-linha-2">
                Lista de qtd. de ocorrências dos servidores
              </div>
                            
              <div class="lista-second-grafico-linha-2">
                <table>
                  <tr>
                    <th>ID</th>
                    <th>Tagname</th>
                    <th>Qtd.Ocorrências</th>
                    <th>Jogo</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>

                  <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Chamado</th>
                    <th>Status</th>
                  </tr>
                </table>
              </div>
            </div>


          </div>
        </div>
      </div>
    </main>
  </body>
</html>

<script>

   function getChamados() {
        fetch('/jira/chamados-abertos')
            .then(res => res.json())
            .then(data => {
                const kpiAbertos = document.getElementById('kpi-chamados-abertos');
                kpiAbertos.textContent = data.length;
            })
            .catch(err => {
                console.error('Erro ao buscar chamados:', err);
                document.getElementById('chamados-container').innerHTML = '<p>Erro ao buscar chamados.</p>';
            });
    }

  const diasDoMes = Array.from({ length: 30 }, (_, i) => `${i + 1}`);

  const chamadosPorDia = [
    5, 3, 4, 6, 7, 5, 4, 3, 5, 6, 8, 7, 6, 4, 5, 7, 8, 6, 5, 4, 6, 7, 5, 4, 6,
    7, 8, 6, 7, 5,
  ];

  const options = {
    chart: {
      type: "line",
      height: 230,
      toolbar: { show: false },
      animations: {
        enabled: true,
      },
    },
    series: [
      {
        name: "Chamados",
        data: chamadosPorDia,
      },
    ],
    stroke: {
      width: 2, // grossura da linha diminuída
      colors: ["#4D1D95"], // cor personalizada da linha
    },
    xaxis: {
      categories: diasDoMes,
      labels: {
        rotate: -45,
        style: {
          fontSize: "12px",
        },
      },
    },
    yaxis: {
      title: {
        text: "Número de Chamados",
      },
    },
    title: {
      text: "",
      align: "center",
    },
    responsive: [
      {
        breakpoint: 1350,
        options: {
          chart: {
            height: 300,
          },
          xaxis: {
            labels: {
              rotate: -30,
              style: {
                fontSize: "10px",
              },
            },
          },
        },
      },
      {
        breakpoint: 480,
        options: {
          chart: {
            height: 180,
          },
          xaxis: {
            labels: {
              rotate: -20,
              style: {
                fontSize: "9px",
              },
            },
          },
        },
      },
    ],
  };

  const chart = new ApexCharts(document.querySelector("#chart"), options);
  chart.render();


</script>
